/*
  sdpi.css - Stream Deck Property Inspector (Star Citizen plugin)

  CLEANUP NOTES (maintainers):
  - This file was restructured to fix nested/missing rules that caused layout breakage.
  - Keep the top-level tokens (CSS custom properties) near the top.
  - Make small, localized edits and avoid duplicating blocks (eg. `.sdpi-wrapper`).
  - File-picker and stacked-layout rules are centralized under the "Stacked layout" section.
  - Body-level scrolling is intentionally disabled so the host (Stream Deck) controls the page scroll.

  If you need to revert to the original theme values, edit the `:root` tokens under the first `html { ... }` block.
*/

/* -----------------------------
   Theme tokens (colors, sizing)
   ----------------------------- */
html {
  --sdpi-bgcolor: #2D2D2D;            /* page background */
  --sdpi-background: #3D3D3D;         /* control backgrounds (inputs, boxes) */
  --sdpi-color: #d8d8d8;              /* primary text color */
  --sdpi-bordercolor: #3a3a3a;        /* borders for boxes */
  --sdpi-buttonbordercolor: #969696;  /* button border */
  --sdpi-borderradius: 0px;           /* default corner radius */
  --sdpi-width: 224px;
  --sdpi-fontweight: 600;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

/* -----------------------------
   Base layout & typography
   ----------------------------- */
html, body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 9pt;
  background-color: var(--sdpi-bgcolor);
  color: #9a9a9a;
}

/* Prevent the page from creating its own scroll area. The Stream Deck host provides the outer scroll. */
body {
  height: 100%;
  padding: 0;
  overflow-x: hidden;
  overflow-y: auto; /* allow vertical scrolling inside PI */
  margin: 0;
  -webkit-overflow-scrolling: touch;
  -webkit-text-size-adjust: 100%;
  -webkit-font-smoothing: antialiased;
}

/* Small utilities */
.linkspan { cursor: pointer; color: #7397d2; text-decoration: underline; }

/* Simple separators used across pages */
hr, hr2 {
  -webkit-margin-before: 1em;
  -webkit-margin-after: 1em;
  border-style: none;
  background: var(--sdpi-background);
  height: 1px;
}

/* Heading visual helper */
hr2, .sdpi-heading {
  display: flex;
  flex-basis: 100%;
  align-items: center;
  color: inherit;
  font-size: 9pt;
  margin: 8px 0px;
}
.sdpi-heading::before, .sdpi-heading::after {
  content: "";
  flex-grow: 1;
  background: var(--sdpi-background);
  height: 1px;
  margin: 0px 16px;
}
hr2 { height: 2px; }
hr, hr2 { margin-left:16px; margin-right:16px; }

/* -----------------------------
   Generic control size tokens
   ----------------------------- */
.sdpi-item-value, option, input, select, button {
  font-size: 10pt;
  font-weight: var(--sdpi-fontweight);
}

/* Platform-specific tweaks */
.win .sdpi-item-value, .win option, .win input, .win select, .win button { font-size: 11px; font-weight: 100; }

/* -----------------------------
   Layout primitives
   ----------------------------- */
.sdpi-wrapper {
  /* Make the wrapper the scrollable area inside the PI window so long pages show a scrollbar */
  overflow-x: hidden;
  overflow-y: auto;
  max-height: calc(100vh - 16px);
  height: auto;
  padding: 6px; /* reduced from 8px for tighter layout */
  box-sizing: border-box;
}

/* rows: label + value */
.sdpi-item {
  display: flex;
  flex-direction: row;
  min-height: 26px; /* reduced from 32px */
  align-items: center;
  margin-top: 2px;
  max-width: none;
}
.sdpi-item:first-child { margin-top:1px; }
.sdpi-item:last-child { margin-bottom: 0px; }

/* slightly smaller controls inside rows */
.sdpi-item > *:not(.sdpi-item-label):not(meter):not(details) { min-height: 24px; padding: 0 3px; }

.sdpi-item-label { text-align: right; flex: none; width: 94px; padding-right: 4px; font-weight: 600; }
.sdpi-item-label:after { content: ": "; }
.sdpi-item-label.empty:after { content: ""; }

.sdpi-test, .sdpi-item-value { flex: 1 0 0; margin-right: 14px; margin-left: 4px; }

/* make most controls look consistent */
input:not([type="range"]), textarea {
  -webkit-appearance: none;
  background: var(--sdpi-background);
  color: var(--sdpi-color);
  font-weight: normal;
  font-size: 9pt;
  border: none;
  margin-top: 2px;
  margin-bottom: 2px;
}

input[type="file"] { display: none !important; }

/* Small helpers */
.hidden { display: none !important; }
.pointer { cursor: pointer; }

/* -----------------------------
   File picker visuals
   Centralized so all inspectors share same look
   ----------------------------- */
.sdpi-file-info {
  background-color: var(--sdpi-background);
  border: 1px solid var(--sdpi-bordercolor);
  border-radius: var(--sdpi-borderradius);
  padding: 6px 8px;
  height: 28px;
  min-height: 28px;
  box-sizing: border-box;
  color: var(--sdpi-color);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  width: 100%;
  display: flex;
  align-items: center;
}

.file-row, .file-main { width: 100%; box-sizing: border-box; }
.file-actions { display: flex; gap: 6px; margin-top: 6px; flex-wrap: wrap; }

/* keep action buttons small and inline */
label.sdpi-file-label, .sdpi-file-button-inline { display: inline-block; }

/* -----------------------------
   Modern theme tokens
   ----------------------------- */
html {
  --sdpi-bgcolor: #2b2b2b;
  --sdpi-background: #333333;
  --sdpi-color: #e6e6e6;
  --sdpi-bordercolor: #444444;
  --sdpi-buttonbordercolor: #444444;
  --sdpi-borderradius: 4px;
  --sdpi-fontweight: 400;
}

/* Standard control sizing used in modern theme */
input.sdpi-item-value, select.sdpi-item-value, button.sdpi-item-value, textarea.sdpi-item-value,
button, input[type="button"], input[type="submit"], label.sdpi-file-label {
  background-color: var(--sdpi-background);
  border: 1px solid var(--sdpi-bordercolor);
  color: var(--sdpi-color);
  border-radius: var(--sdpi-borderradius);
  padding: 5px 6px; /* slightly tighter padding */
  /* slightly shorter to avoid scrolling */
  min-height: 28px !important; /* reduced from 32px */
  height: 28px;
  font-size: 10pt;
  box-sizing: border-box;
}

/* -----------------------------
   Opt-in stacked layout (sdpi-stack)
   - Use this class on `.sdpi-wrapper` to stack labels above controls.
   - Keep this block logically grouped and fully closed.
   ----------------------------- */
.sdpi-wrapper.sdpi-stack .sdpi-item {
  display: flex !important;
  flex-direction: column !important;
  align-items: stretch !important;
  gap: 2px !important;              /* label â†’ control gap (tweakable, reduced) */
  margin: 0 0 6px 0 !important;     /* gap between sections (reduced) */
  min-height: 0 !important;
}

.sdpi-wrapper.sdpi-stack .sdpi-item-label {
  width: auto !important;
  text-align: left !important;
  margin: 0 !important;
  padding: 0 !important;
  line-height: 1.1 !important;
}

.sdpi-wrapper.sdpi-stack .sdpi-item-value,
.sdpi-wrapper.sdpi-stack select.sdpi-item-value,
.sdpi-wrapper.sdpi-stack input.sdpi-item-value,
.sdpi-wrapper.sdpi-stack textarea.sdpi-item-value,
.sdpi-wrapper.sdpi-stack .sdpi-item-group,
.sdpi-wrapper.sdpi-stack .sdpi-file-info {
  width: 100% !important;
  box-sizing: border-box !important;
  margin: 0 !important;
}

/* File picker in stacked layout */
.sdpi-wrapper.sdpi-stack .file-row,
.sdpi-wrapper.sdpi-stack .sdpi-item-group.file {
  display: flex !important;
  flex-direction: column !important;
  gap: 4px !important; /* tighten file picker vertical gap */
  align-items: stretch !important;
  width: 100% !important;
}

.sdpi-wrapper.sdpi-stack .file-actions {
  display: flex !important;
  flex-direction: row !important;
  gap: 6px !important;
  align-items: center !important;
  justify-content: flex-start !important;
  margin-top: 4px !important; /* reduced from 6px */
}

/* Keep informational details blocks separated from file actions */
.sdpi-wrapper.sdpi-stack details {
  display: block;
  margin-top: 8px; /* small spacing but no border */
  padding-top: 8px;
  width: 100%;
  box-sizing: border-box;
  border-top: none; /* removed the separator line above "How it works" */
}

/* Search helper spacing */
.sdpi-wrapper.sdpi-stack #searchResults { margin-top: 0 !important; }

/* -----------------------------
   SDPI Section helpers - unified professional look
   - `.sdpi-section` wraps related controls (label + value rows)
   - Works in both stacked (`.sdpi-stack`) and inline layouts
   - Keeps spacing predictable so different inspector pages match
   ----------------------------- */

.sdpi-section {
  --pad: 6px; /* reduced from 8px for even tighter sections */
  border-radius: calc(var(--sdpi-borderradius) + 2px);
  padding: var(--pad);
  margin-bottom: 6px; /* reduced spacing between sections */
  background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
  border: 1px solid rgba(255,255,255,0.03);
  box-sizing: border-box;
}

/* Slight divider when sections stack */
.sdpi-section + .sdpi-section { border-top: 1px solid rgba(255,255,255,0.02); }

/* Rich section header with optional icon */
.sdpi-section > .sdpi-section-title {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 9pt; /* slightly smaller */
  color: var(--sdpi-color);
  margin-bottom: 4px; /* reduced gap between title and content */
  font-weight: 700;
}

.sdpi-section-icon {
  width: 36px;
  height: 36px;
  min-width: 36px;
  border-radius: 6px;
  background: var(--sdpi-background);
  border: 1px solid var(--sdpi-bordercolor);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--sdpi-color);
}

/* Normalize label/value spacing inside sections */
.sdpi-section .sdpi-item { margin-top: 2px; margin-bottom: 2px; display:flex; align-items:center; }
.sdpi-section .sdpi-item-label { width: 110px; text-align: left; padding-right: 6px; color: #d0d0d0; }
.sdpi-section .sdpi-item-value { margin-left: 0; margin-right: 0; flex:1; }

/* Compact helper to reduce vertical spacing when needed */
.sdpi-section.compact .sdpi-item { margin-top: 1px; margin-bottom: 1px; }

/* Make file pickers consistent inside sections */
.sdpi-section .sdpi-file-info { height: 26px; min-height: 26px; }
.sdpi-section .file-actions { margin-top: 2px; }

/* Ensure details sits as its own section at the bottom */
.sdpi-section.details { padding-top: 6px; }

/* Reduce spacing specifically for the Search section */
.sdpi-section--search { padding-top: 6px; padding-bottom: 6px; }
.sdpi-section--search .sdpi-item { margin-top: 2px; margin-bottom: 2px; }
.sdpi-section--search .sdpi-item-value { padding-bottom: 2px; }
#searchResults { margin-top: 2px; margin-bottom: 0; font-size: 11px; }

/* Keep overall page tight but readable */
.sdpi-wrapper { padding: 6px !important; }

/* Restore modern label width inside stacked layout to match screenshot guideline */
.sdpi-wrapper.sdpi-stack .sdpi-item-label { width: auto !important; }

/* Make sure search row displays consistently */
.search-row { display: flex; gap: 6px; align-items: center; }
.search-row input.sdpi-item-value { flex: 1; }

/* Helpers for specific logical sections to keep consistent visuals */
.sdpi-section--search .search-row { align-items:center; }
.sdpi-section--function .sdpi-item { gap:8px; }
.sdpi-section--sound .file-actions { justify-content:flex-start; }

/* Small responsive tweaks to keep layout neat */
@media (max-width: 420px) {
  .sdpi-section .sdpi-item-label { width: 90px; }
}
@media (max-width: 320px) {
  .sdpi-section .sdpi-item { flex-direction: column; align-items: stretch; }
  .sdpi-section .sdpi-item-label { text-align: left; width: auto; padding-bottom: 4px; }
}

/* Custom scrollbar styling to match PI dark theme */
/* Apply to main content areas and any popup lists */
.sdpi-wrapper, .sdpi-section, .sdpi-item-value, select, .sdpi-popup {
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: rgba(255,255,255,0.06) transparent; /* Firefox thumb track */
}

/* WebKit-based browsers (Chrome/Edge/Chromium in Stream Deck) */
.sdpi-wrapper::-webkit-scrollbar,
.sdpi-section::-webkit-scrollbar,
.sdpi-item-value::-webkit-scrollbar,
select::-webkit-scrollbar,
.sdpi-popup::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.sdpi-wrapper::-webkit-scrollbar-track,
.sdpi-section::-webkit-scrollbar-track,
.sdpi-item-value::-webkit-scrollbar-track,
select::-webkit-scrollbar-track,
.sdpi-popup::-webkit-scrollbar-track {
  background: transparent;
}

.sdpi-wrapper::-webkit-scrollbar-thumb,
.sdpi-section::-webkit-scrollbar-thumb,
.sdpi-item-value::-webkit-scrollbar-thumb,
select::-webkit-scrollbar-thumb,
.sdpi-popup::-webkit-scrollbar-thumb {
  background-color: rgba(255,255,255,0.06);
  border-radius: 8px;
  border: 2px solid rgba(0,0,0,0.0);
}

/* Hover/focus state for better affordance */
.sdpi-wrapper::-webkit-scrollbar-thumb:hover,
.sdpi-section::-webkit-scrollbar-thumb:hover,
.sdpi-item-value::-webkit-scrollbar-thumb:hover,
select::-webkit-scrollbar-thumb:hover,
.sdpi-popup::-webkit-scrollbar-thumb:hover {
  background-color: rgba(255,255,255,0.12);
}

/* A slightly stronger thumb for scrollbar tracks inside sections */
.sdpi-section {
  --sdpi-scroll-thumb: rgba(255,255,255,0.06);
}

/* Accessibility: reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  * { scroll-behavior: auto !important; }
}
